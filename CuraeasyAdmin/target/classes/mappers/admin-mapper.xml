<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminMapper">
    
    <!-- Result Maps -->
	<resultMap id="displayResultSet" type="com.kh.curaeasyadmin.model.vo.Display">
	    <result column="DISPLAY_NO" property="displayNo" />
	    <result column="DISPLAY_NAME" property="displayName" />
	    <result column="DISPLAY_CONTENT" property="displayContent" />
	    <result column="DISPLAY_START_DATE" property="displayStartDate" />
	    <result column="DISPLAY_END_DATE" property="displayEndDate" />
	    <result column="DISPLAY_PRICE" property="displayPrice" />
	    <result column="DISPLAY_STATUS" property="displayStatus" />
	    <result column="ARTIST_NO" property="artistNo" />
	    <result column="GALLERY_NO" property="galleryNo" />
	    <result column="IMAGE_PATH" property="imagePath" />
	    <result column="GALLERY_NAME" property="galleryName" />
	    <result column="ARTIST_NICKNAME" property="artistNickName" />
	</resultMap>

    <resultMap id="galleryResultSet" type="gallery">
        <result column="GALLERY_NO" property="galleryNo" />
        <result column="GALLERY_NAME" property="galleryName" />
        <result column="GALLERY_PLACE" property="galleryPlace" />
        <result column="GALLERY_INFO" property="galleryInfo" />
        <result column="GALLERY_TYPE" property="galleryType" />
    </resultMap>

    <resultMap id="noticeResultSet" type="notice">
        <result column="NOTICE_NO" property="noticeNo" />
        <result column="NOTICE_TITLE" property="noticeTitle" />
        <result column="NOTICE_CONTENT" property="noticeContent" />
        <result column="NOTICE_DATE" property="noticeDate" />
        <result column="NOTICE_ATTACHMENT" property="noticeAttachment" />
        <result column="NOTICE_COUNT" property="noticeCount" />
        <result column="NOTICE_STATUS" property="noticeStatus" />
        <result column="NOTICE_COUNT" property="noticeCount" />
    </resultMap>

    <resultMap id="reviewResultSet" type="review">
        <result column="REVIEW_NO" property="reviewNo" />
        <result column="REVIEW_TITLE" property="reviewTitle" />
        <result column="REVIEW_CONTENT" property="reviewContent" />
        <result column="REVIEW_ENROLL_DATE" property="reviewEnrollDate" />
        <result column="REVIEW_COUNT" property="reviewCount" />
        <result column="REVIEW_IMAGE" property="reviewImage" />
        <result column="REVIEW_STATUS" property="reviewStatus" />
        <result column="MEMBER_NO" property="memberNo" />
    </resultMap>

    <resultMap id="replyResultSet" type="reply">
        <result column="REPLY_NO" property="replyNo" />
        <result column="REPLY_CONTENT" property="replyContent" />
        <result column="REPLY_ENROLL_DATE" property="replyEnrollDate" />
        <result column="REPLY_STATUS" property="replyStatus" />
        <result column="REVIEW_NO" property="reviewNo" />
        <result column="MEMBER_NO" property="memberNo" />
    </resultMap>

    <resultMap id="rentalResultSet" type="rental">
        <result column="RENTAL_NO" property="rentalNo" />
        <result column="RENTAL_APPLY_DATE" property="rentalApplyDate" />
        <result column="RENTAL_START_DATE" property="rentalStartDate" />
        <result column="RENTAL_END_DATE" property="rentalEndDate" />
        <result column="RENTAL_CONTENT" property="rentalContent" />
        <result column="RENTAL_RESULT" property="rentalResult" />
        <result column="RENTAL_STATUS" property="rentalStatus" />
        <result column="ARTIST_NO" property="artistNo" />
        <result column="GALLERY_NO" property="galleryNo" />
    </resultMap>

    <resultMap id="reserveResultSet" type="reserve">
        <result column="RESERVE_NO" property="reserveNo" />
        <result column="RESERVE_COUNT" property="reserveCount" />
        <result column="PAYMENT_CODE" property="paymentCode" />
        <result column="PAYMENT_DATE" property="paymentDate" />
        <result column="ENTRANCE_DATE" property="entranceDate" />
        <result column="PAYMENT_PRICE" property="paymentPrice" />
        <result column="RESERVE_STATUS" property="reserveStatus" />
        <result column="MEMBER_NO" property="memberNo" />
        <result column="DISPLAY_NO" property="displayNo" />
    </resultMap>

	<resultMap id="memberResultSet" type="member">
	    <result column="MEMBER_NO" property="memberNo" />
	    <result column="MEMBER_ID" property="memberId" />
	    <result column="MEMBER_PWD" property="memberPwd" />
	    <result column="MEMBER_NAME" property="memberName" />
	    <result column="MEMBER_PHONE" property="memberPhone" />
	    <result column="MEMBER_EMAIL" property="memberEmail" />
	    <result column="MEMBER_ADDRESS" property="memberAddress" />
	    <result column="MEMBER_BIRTHDAY" property="memberBirthday" />
	    <result column="MEMBER_ENROLL_DATE" property="memberEnrollDate" />
	    <result column="ARTIST_ONGOING" property="artistOngoing" />
	    <result column="MEMBER_STATUS" property="memberStatus" />
	</resultMap>

    <resultMap id="artistResultSet" type="artist">
        <result column="ARTIST_NO" property="artistNo" />
        <result column="ARTIST_NICKNAME" property="artistNickName" />
        <result column="ARTIST_ORDINAL" property="artistOrdinal" />
        <result column="ARTIST_APPLY_DATE" property="artistApplyDate" />
        <result column="ARTIST_APPLY_TITLE" property="artistApplyTitle" />
        <result column="ARTIST_INTRODUCE" property="artistIntroduce" />
        <result column="ARTIST_IMAGE" property="artistImage" />
        <result column="ARTIST_RESULT" property="artistResult" />
        <result column="ARTIST_STATUS" property="artistStatus" />
        <result column="MEMBER_NO" property="memberNo" />
    </resultMap>

    <!-- Select Statements -->

    <select id="getDisplayListCount" parameterType="String" resultType="int">
        SELECT COUNT(*)
        FROM DISPLAY D
        JOIN ARTIST A ON D.ARTIST_NO = A.ARTIST_NO
        JOIN GALLERY G ON D.GALLERY_NO = G.GALLERY_NO
        WHERE D.DISPLAY_NAME LIKE '%' || #{searchKeyword} || '%'
        OR D.DISPLAY_CONTENT LIKE '%' || #{searchKeyword} || '%'
        OR A.ARTIST_NICKNAME LIKE '%' || #{searchKeyword} || '%'
    </select>

    <select id="selectDisplayList" parameterType="String" resultMap="displayResultSet">
        SELECT 
            D.DISPLAY_NO,
            D.DISPLAY_NAME,
            D.DISPLAY_CONTENT,
            D.DISPLAY_START_DATE,
            D.DISPLAY_END_DATE,
            D.DISPLAY_PRICE,
            D.DISPLAY_STATUS,
            A.ARTIST_NICKNAME,
            G.GALLERY_NAME
        FROM DISPLAY D
        JOIN ARTIST A ON D.ARTIST_NO = A.ARTIST_NO
        JOIN GALLERY G ON D.GALLERY_NO = G.GALLERY_NO
        WHERE D.DISPLAY_NAME LIKE '%' || #{searchKeyword} || '%'
        OR D.DISPLAY_CONTENT LIKE '%' || #{searchKeyword} || '%'
        OR A.ARTIST_NICKNAME LIKE '%' || #{searchKeyword} || '%'
        ORDER BY D.DISPLAY_NO DESC
    </select>
    
	<select id="selectDisplay" parameterType="int" resultMap="displayResultSet">
	    SELECT 
	        D.DISPLAY_NO,
	        D.DISPLAY_NAME,
	        D.DISPLAY_CONTENT,
	        TO_CHAR(D.DISPLAY_START_DATE, 'YYYY-MM-DD') AS DISPLAY_START_DATE,
	        TO_CHAR(D.DISPLAY_END_DATE, 'YYYY-MM-DD') AS DISPLAY_END_DATE,
	        D.DISPLAY_PRICE,
	        D.DISPLAY_STATUS,
	        D.ARTIST_NO,
	        D.GALLERY_NO,
	        (SELECT CHANGE_NAME FROM DISPLAY_ATTACHMENT WHERE DISPLAY_NO = D.DISPLAY_NO AND IMAGE_LEVEL = 1 AND ROWNUM = 1) AS IMAGE_PATH,
	        G.GALLERY_NAME,
	        A.ARTIST_NICKNAME
	    FROM 
	        DISPLAY D
	    JOIN 
	        GALLERY G ON D.GALLERY_NO = G.GALLERY_NO
	    JOIN 
	        ARTIST A ON D.ARTIST_NO = A.ARTIST_NO
	    WHERE 
	        D.DISPLAY_NO = #{displayNo}
	</select>
    
     <delete id="deleteDisplay">
        DELETE FROM DISPLAY WHERE DISPLAY_NO = #{displayNo}
    </delete>

    <select id="selectNoticeList" resultMap="noticeResultSet">
        SELECT 
            NOTICE_NO,
            NOTICE_TITLE,
            NOTICE_CONTENT,
            NOTICE_DATE,
            NOTICE_ATTACHMENT,
            NOTICE_COUNT,
            NOTICE_STATUS
        FROM 
            NOTICE
        ORDER BY 
            NOTICE_NO
    </select>

	<select id="selectMemberList" resultMap="memberResultSet">
	    SELECT 
	        MEMBER_NO,
	        MEMBER_ID,
	        MEMBER_PWD,
	        MEMBER_NAME,
	        MEMBER_PHONE,
	        MEMBER_EMAIL,
	        MEMBER_ADDRESS,
	        TO_CHAR(MEMBER_BIRTHDAY, 'YYYY-MM-DD') AS MEMBER_BIRTHDAY,
	        TO_CHAR(MEMBER_ENROLL_DATE, 'YYYY-MM-DD') AS MEMBER_ENROLL_DATE,
	        ARTIST_ONGOING,
	        MEMBER_STATUS
	    FROM 
	        MEMBER
	    ORDER BY 
	        MEMBER_NO
	</select>

    <select id="selectRentalList" resultMap="rentalResultSet">
        SELECT 
            RENTAL_NO,
            TO_CHAR(RENTAL_APPLY_DATE, 'YYYY-MM-DD') AS RENTAL_APPLY_DATE,
            TO_CHAR(RENTAL_START_DATE, 'YYYY-MM-DD') AS RENTAL_START_DATE,
            TO_CHAR(RENTAL_END_DATE, 'YYYY-MM-DD') AS RENTAL_END_DATE,
            RENTAL_CONTENT,
            RENTAL_RESULT,
            RENTAL_STATUS,
            ARTIST_NO,
            GALLERY_NO
        FROM 
            RENTAL
        ORDER BY 
            RENTAL_NO
    </select>

    <select id="selectReserveList" resultMap="reserveResultSet">
        SELECT 
            RESERVE_NO,
            RESERVE_COUNT,
            PAYMENT_CODE,
            TO_CHAR(PAYMENT_DATE, 'YYYY-MM-DD') AS PAYMENT_DATE,
            TO_CHAR(ENTRANCE_DATE, 'YYYY-MM-DD') AS ENTRANCE_DATE,
            PAYMENT_PRICE,
            RESERVE_STATUS,
            MEMBER_NO,
            DISPLAY_NO
        FROM 
            RESERVE
        ORDER BY 
            RESERVE_NO
    </select>

    <select id="selectReviewList" resultMap="reviewResultSet">
        SELECT 
            REVIEW_NO,
            REVIEW_TITLE,
            REVIEW_CONTENT,
            TO_CHAR(REVIEW_ENROLL_DATE, 'YYYY-MM-DD') AS REVIEW_ENROLL_DATE,
            REVIEW_COUNT,
            REVIEW_IMAGE,
            REVIEW_STATUS,
            MEMBER_NO
        FROM 
            REVIEW
        ORDER BY 
            REVIEW_NO
    </select>

    <select id="selectReplyList" resultMap="replyResultSet">
        SELECT 
            REPLY_NO,
            REPLY_CONTENT,
            TO_CHAR(REPLY_ENROLL_DATE, 'YYYY-MM-DD') AS REPLY_ENROLL_DATE,
            REPLY_STATUS,
            REVIEW_NO,
            MEMBER_NO
        FROM 
            REPLY
        ORDER BY 
            REPLY_NO
    </select>

    <select id="selectGalleryList" resultMap="galleryResultSet">
        SELECT 
            GALLERY_NO,
            GALLERY_NAME,
            GALLERY_PLACE,
            GALLERY_INFO,
            GALLERY_TYPE
        FROM 
            GALLERY
        ORDER BY 
            GALLERY_NO
    </select>

    <select id="selectArtistList" resultMap="artistResultSet">
        SELECT 
            ARTIST_NO,
            ARTIST_NICKNAME,
            ARTIST_ORDINAL,
            ARTIST_APPLY_DATE,
            ARTIST_APPLY_TITLE,
            ARTIST_INTRODUCE,
            ARTIST_IMAGE,
            ARTIST_RESULT,
            ARTIST_STATUS,
            MEMBER_NO
        FROM 
            ARTIST
        ORDER BY 
            ARTIST_NO
    </select>
</mapper>
